<Deployment Name="Gatekeeper - RegFix Only" OrderPriority="0">
	<Description>
	Applies the Gatekeeper ODBC registry fix only.
	
	Execute this item if a user is getting a prompt for database/server info when trying to launch Gatekeeper.
	</Description>
	
	<Command Type="Prompt">
		<LogMessage Type="Notice">
			Applying Gatekeeper Registry Fix...
		</LogMessage>
		<LogMessage Type="Notice">
			Starting remote session and invoking script...
		</LogMessage>
	</Command>
		
	<Command Type="SimplePowerShellCommand" Title="Gatekeeper Registry Fix">
		<PSCommands>
			<PSCommand Value="Remove-ItemProperty">
				<PSParameter Name="Path" Value="HKLM:\SOFTWARE\Wow6432Node\ODBC\ODBC.INI\Gatekeeper"/>
				<PSParameter Name="Name" Value="CommLinks"/>
			</PSCommand>
		</PSCommands>
		<OnSuccess>
			<Command Type="Prompt">
				<LogMessage Type="Success">
				GK Registry fix applied!
				</LogMessage>
			</Command>
		</OnSuccess>
		<OnFailure>
			<Command Type="Prompt">
				<LogMessage Type="Error">
				Failed to apply GK Registry fix!
				</LogMessage>
				<DialogPrompt Title="Gatekeeper Deployment Error">
				Error occurred while executing command!
				</DialogPrompt>
			</Command>
		</OnFailure>
	</Command>
	
</Deployment>