<Deployment Name="Gatekeeper" OrderPriority="0">
	
	<Command Type="SimplePSExec" Title="Gatekeeper Client Install">
		<String>
		msiexec.exe /i \\svr-ddas1.core.co.fairfield.oh.us\PSiServ\Gatekeeper\Install\Full\ClientFull.msi /qn /norestart
		</String>
	</Command>
	
	<Command Type="SimplePSExec" Title="Gatekeeper Update Install">
		<String>
		msiexec.exe /i \\svr-ddas1.core.co.fairfield.oh.us\PSiServ\Gatekeeper\Install\Upgrade\Setup.msi /qn /norestart
		</String>
	</Command>
	
	<Command Type="Prompt">
		<LogMessage Type="Notice">
			Applying Gatekeeper Registry Fix...
		</LogMessage>
		<LogMessage Type="Notice">
			Starting remote session and invoking script...
		</LogMessage>
	</Command>
		
	<Command Type="SimplePowerShellCommand" Title="Gatekeeper Registry Fix">
		<PSCommands>
			<PSCommand IsScript="True" Value="Remove-ItemProperty">
				<PSParameter Name="Path" Value="HKLM:\SOFTWARE\Wow6432Node\ODBC\ODBC.INI\Gatekeeper"/>
				<PSParameter Name="Name" Value="CommLinks"/>
			</PSCommand>
		</PSCommands>
		<OnSuccess>
			<Command Type="Prompt">
				<LogMessage Type="Success">
				GK Registry fix applied!
				</LogMessage>
			</Command>
		</OnSuccess>
		<OnFailure>
			<Command Type="Prompt">
				<LogMessage Type="Error">
				Failed to apply GK Registry fix!
				</LogMessage>
				<DialogPrompt Title="Gatekeeper Deployment Error">
				Error occurred while executing command!
				</DialogPrompt>
			</Command>
		</OnFailure>
	</Command>
	
</Deployment>