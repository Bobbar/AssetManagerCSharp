<Deployment Name="Remove Win 10 OEM Office Packages">
	<Description>
	Removes Office apps built into Windows 10. 
	
	These apps often conflict with company deployed Office versions and should be removed.
	
	Attempts to resolve the following issues:
	- Excel opening blank 
	- Outlook crashing at signature window 
	- Duplicate Office icons, 
	
	This script is already included within the Office deployment script.
	</Description>
	
	<Command Type="Prompt">
		<LogMessage Type="Notice" Value="Removing provisioned Office Packages..."/>
	</Command>
	
	<Command Type="SimplePowerShellCommand" Title="Remove Windows 10 OEM Office Packages">
	
		<PSCommands>
			<PSCommand IsScript="True">
				Get-AppxProvisionedPackage -Online | %{if ($_.packagename -match "Microsoft.Office.Desktop") {$_ | Remove-AppxProvisionedPackage -AllUsers}}
			</PSCommand>
			
			<PSCommand IsScript="True">
				Get-AppxProvisionedPackage -Online | %{if ($_.packagename -match "Microsoft.Office.OneNote") {$_ | Remove-AppxProvisionedPackage -AllUsers}}
			</PSCommand>
			
			<PSCommand IsScript="True">
				Get-AppxProvisionedPackage -Online | %{if ($_.packagename -match "Microsoft.MicrosoftOfficeHub") {$_ | Remove-AppxProvisionedPackage -AllUsers}}
			</PSCommand>
			
		</PSCommands>
		
		<OnSuccess>
			<Command Type="Prompt">
				<LogMessage Type="Success" Value="Windows 10 OEM Office packages removed."/>
			</Command>
		</OnSuccess>
		<OnFailure>
			<Command Type="Prompt">
				<LogMessage Type="Error" Value="Failed to remove Windows 10 Office duplicates!"/>
				<DialogPrompt Value="Error occurred while executing deployment command!"/>
			</Command>
		</OnFailure>
			
	</Command>
	
</Deployment>